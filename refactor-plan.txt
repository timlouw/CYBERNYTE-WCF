============================================================
PROJECT: CUSTOM TS FRAMEWORK COMPILER & RUNTIME REWRITE
STRATEGY: HOLISTIC, AST-DRIVEN, ZERO-DEPENDENCY
============================================================

PROGRESS TRACKING (Updated: 2026-01-18)
---------------------------------------
[✓] Step A: Pipeline Runner & Config - COMPLETED
[✓] Step B: Port TS transforms to AST - COMPLETED
[✓] Step C: Consolidate HTML parsing - COMPLETED
[✓] Step D: Implement Debug Tap - COMPLETED

METRICS:
- Baseline tests: 278 passing (10 skipped runtime tests)
- After refactor: 295 passing (17 new pipeline tests added)
- Build time: ~1.35s (consistent, no regression)
- Zero new dependencies added

COMPLETED DELIVERABLES:
- framework/compiler/pipeline/pipeline-config.ts - Plugin toggles & config schema
- framework/compiler/pipeline/pipeline-runner.ts - Plugin orchestration with debug tap
- framework/compiler/debug-tap.ts - CLI utility for debugging transforms
- framework/compiler/utils/html-parser.ts - Extended with 12 new utility functions
- Removed duplicate injectIdIntoFirstElement from reactive-binding-compiler
- Exposed transformReactiveBindings for direct transform testing

============================================================

1. PRE-REQUISITE: ARCHITECTURAL AUDIT & UNDERSTANDING
-----------------------------------------------------
* DEEP AUDIT: Perform a holistic review of current runtime 
  and compiler logic before any code is deleted.
* MAP DEPENDENCIES: Document current dependency list to 
  ensure 0 new packages are introduced.
* REGEX ELIMINATION: Identify all Regex transformations in 
  TypeScript code paths and convert to AST equivalents.
* INTERDEPENDENCY MAPPING: Define the order of feature 
  execution to prevent breaking downstream logic.

2. CORE GOALS
-------------
* PRODUCTION STABILITY: Resilience against minor app-setup 
  changes and configuration shifts.
* DOMAIN REDUCTION: Minimize codebase surface area; 
  aggressively remove redundant logic and legacy hacks.
* ZERO NEW PACKAGES: Strictly utilize existing dependencies 
  (esbuild, typescript).
* AST-FIRST FOR TYPESCRIPT: Maximum AST usage for all 
  TypeScript code transformations. Regex is NOT acceptable 
  for TS code manipulation (imports, classes, expressions).
* HTML/CSS CONCESSION: Regex and state-machine parsing ARE 
  acceptable for:
  - HTML template string processing (inside template literals)
  - CSS string manipulation and minification
  - Whitespace normalization
  Rationale: TypeScript AST cannot parse HTML/CSS content 
  within string literals. State machine or regex is the 
  correct tool for string-based DSLs.

3. COMPOSABLE ARCHITECTURE & INTEGRATION
----------------------------------------
* PLUGIN SYSTEM: Implement a "Pass-through" architecture 
  where features act as modular plugins.
* HOST: esbuild Plugin API exclusively (onLoad/onResolve).
  Note: tsc Transformer API dropped—incompatible paradigm 
  with string-based transforms; no .d.ts emit needed.
* FEATURE TOGGLES: Allow features to be switched on/off via 
  a (rewritable) config file without breaking the pipeline.
* RECURSIVE INTEGRITY: HTML directives, functions, and 
  bindings must support infinite recursive nesting through 
  proper tree-based parsing. Consolidate overlapping logic 
  in html-parser.ts and reactive-binding-compiler.ts into 
  a single unified parser.

4. OBSERVABILITY & DEBUGGING
----------------------------
* DEBUG TAP: Implement per-plugin output mode that writes 
  transformed code to disk after EACH plugin executes.
  Output: {debugOutputDir}/{step}-{pluginName}-{filename}
* SNAPSHOT VALIDATION: Continuous verification against 
  existing test suites to ensure zero functional regressions.

5. EXECUTION STEPS
------------------
Step A: Build the "Pipeline Runner" (The harness) and 
        centralized configuration schema.
        - PipelineConfig interface with plugin toggles
        - debugTap: boolean, debugOutputDir: string
        - environment: 'dev' | 'prod'

Step B: Port TypeScript transforms to pure AST:
        - Import manipulation (already AST ✓)
        - Class modification / signal detection (already AST ✓)
        - registerComponent stripping (already AST ✓)
        - Audit remaining TS regex and convert to AST

Step C: Consolidate HTML parsing:
        - Unify html-parser.ts and reactive-binding-compiler 
          parsing logic into single-pass extractor
        - Generate binding descriptors with full context
        - Single code generator for all binding types

Step D: Implement Debug Tap and verify against test suite.
        - Output intermediate files per plugin step
        - Run existing snapshot/integration tests
        - Visual inspection of transformation pipeline
============================================================